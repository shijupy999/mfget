document.addEventListener("DOMContentLoaded", function () {
    populateMaterialGrades('inch');
    populateMaterialGrades('metric');

    document.querySelectorAll('input[name="unit-system"]').forEach((radio) => {
        radio.addEventListener("change", toggleUnitSystem);
    });

    document.getElementById("materialGradeInch").addEventListener("change", resetPriceFieldColors);
    document.getElementById("materialGradeMetric").addEventListener("change", resetPriceFieldColors);

    document.getElementById("materialTypeInch").addEventListener("change", toggleInnerDiaInch);
    document.getElementById("materialTypeMetric").addEventListener("change", toggleInnerDiaMetric);

    toggleInnerDiaInch();
    toggleInnerDiaMetric();
    toggleUnitSystem();

    enableEditingCorrectionTable();
});

const pricePerPoundData = {
    "1015": {
        "Bar": {
            "0-1.99": { min: 1.95, avg: 1.95, max: 1.95 },
            "2-3.99": { min: 1.95, avg: 1.95, max: 1.95 },
            "4-6.99": { min: 1.95, avg: 1.95, max: 1.95 },
            "7-9.99": { min: 1.95, avg: 1.95, max: 1.95 },
            "10-13.99": {min: 1.95, avg: 1.95, max: 1.95 },
            "14-22": { min:1.95, avg: 1.95, max: 1.95 }
       },
        "Tube": {
            "0-1.99": { min: 1.95, avg: 1.95, max: 1.95 },
            "2-3.99": { min: 1.95, avg: 1.95, max: 1.95 },
            "4-6.99": { min: 1.95, avg: 1.95, max: 1.95 },
            "7-9.99": { min: 1.95, avg: 1.95, max: 1.95 },
            "10-13.99": { min: 1.95, avg: 1.95, max: 1.95 },
            "14-22": { min: 1.95, avg: 1.95, max: 1.95 }
       }
    },
    "1018": {
        "Bar": {     
            "0-1.99": { min: 0.91, avg: 1.38, max: 1.56 },
            "2-3.99": { min: 1.33, avg: 1.58, max: 1.96 },
            "4-6.99": { min: 0.91, avg: 1.08, max: 1.23 },
            "7-9.99": { min: 0.91, avg: 0.95, max: 0.99 },
            "10-13.99": { min: 1.11, avg: 1.14, max: 1.14 },
            "14-22": { min: 1.14, avg: 1.14, max: 1.14 }
         },
         "Tube": {     
            "0-1.99": { min: 1.28, avg: 1.38, max: 1.56 },
            "2-3.99": { min: 1.33, avg: 1.58, max: 1.96 },
            "4-6.99": { min: 1.63, avg: 1.64, max: 1.65 },
            "7-9.99": { min: 1.64, avg: 2.00, max: 2.58 },
            "10-13.99": { min: 1.64, avg: 1.64, max: 1.64 },
            "14-22": { min: 1.64, avg: 1.64, max: 1.64 }
       }
    },
    "1040": {
        "Bar": {      
            "0-1.99": { min: 0.44, avg: 0.68, max: 0.85 },
            "2-3.99": { min: 0.42, avg: 0.46, max: 0.57 },
            "4-6.99": { min: 0.42, avg: 0.71, max: 1.14 },
            "7-9.99": { min: 0.68, avg: 1.02, max: 1.08 },
            "10-13.99": { min: 0.76, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
       },          
        "Tube": {      
            "0-1.99": { min: 0.44, avg: 0.68, max: 0.85 },
            "2-3.99": { min: 0.42, avg: 0.46, max: 0.57 },
            "4-6.99": { min: 0.42, avg: 0.71, max: 1.14 },
            "7-9.99": { min: 0.68, avg: 1.02, max: 1.08 },
            "10-13.99": { min: 0.76, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }          
       }
    },
    "1044": {
        "Bar": {      
            "0-1.99": { min: 0.74, avg: 0.91, max: 1.25 },
            "2-3.99": { min: 0.74, avg: 0.91, max: 1.25 },
            "4-6.99": { min: 0.74, avg: 0.91, max: 1.25 },
            "7-9.99": { min: 0.74, avg: 0.91, max: 1.25 },
            "10-13.99": { min: 0.74, avg: 0.91, max: 1.25 },
            "14-22": { mmin: 0.74, avg: 0.91, max: 1.25 }
        },         
        "Tube": {      
            "0-1.99": { min: 0.74, avg: 0.91, max: 1.25 },
            "2-3.99": { min: 0.74, avg: 0.91, max: 1.25 },
            "4-6.99": { min: 0.74, avg: 0.91, max: 1.25 },
            "7-9.99": { min: 0.74, avg: 0.91, max: 1.25 },
            "10-13.99": { min: 0.74, avg: 0.91, max: 1.25 },
            "14-22": { min: 0.74, avg: 0.91, max: 1.25 }          
       }
    },
    "4130-70": {
        "Bar": {      
            "0-1.99": { min: 1.81, avg: 1.81, max: 1.82 },
            "2-3.99": { min: 1.80, avg: 1.83, max: 1.96 },
            "4-6.99": { min: 1.82, avg: 1.83, max: 1.83 },
            "7-9.99": { min: 1.82, avg: 1.83, max: 1.83 },
            "10-13.99": { min: 1.82, avg: 1.82, max: 1.82 },
            "14-22": { min: 1.35, avg: 1.78, max: 1.82 }
       },          
        "Tube": {      
            "0-1.99": { min: 1.81, avg: 1.81, max: 1.82 },
            "2-3.99": { min: 1.80, avg: 1.83, max: 1.96 },
            "4-6.99": { min: 1.80, avg: 1.83, max: 2.21 },
            "7-9.99": { min: 1.82, avg: 1.90, max: 2.26 },
            "10-13.99": { min: 1.82, avg: 1.82, max: 1.82 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }          
       }
    },
    "4130-80": {
        "Bar": {      
            "0-1.99": { min: 1.81, avg: 1.81, max: 1.82 },
            "2-3.99": { min: 1.80, avg: 1.83, max: 1.96 },
            "4-6.99": { min: 1.82, avg: 1.83, max: 1.83 },
            "7-9.99": { min: 1.82, avg: 1.83, max: 1.83 },
            "10-13.99": { min: 1.82, avg: 1.82, max: 1.82 },
            "14-22": { min: 1.35, avg: 1.78, max: 1.82 }
       },          
        "Tube": {      
            "0-1.99": { min: 1.81, avg: 1.81, max: 1.82 },
            "2-3.99": { min: 1.80, avg: 1.83, max: 1.96 },
            "4-6.99": { min: 1.80, avg: 1.83, max: 2.21 },
            "7-9.99": { min: 1.82, avg: 1.90, max: 2.26 },
            "10-13.99": { min: 1.82, avg: 1.82, max: 1.82 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }          
       }
    },
    "4130-90": {
        "Bar": {      
            "0-1.99": { min: 1.81, avg: 1.81, max: 1.82 },
            "2-3.99": { min: 1.80, avg: 1.83, max: 1.96 },
            "4-6.99": { min: 1.82, avg: 1.83, max: 1.83 },
            "7-9.99": { min: 1.82, avg: 1.83, max: 1.83 },
            "10-13.99": { min: 1.82, avg: 1.82, max: 1.82 },
            "14-22": { min: 1.35, avg: 1.78, max: 1.82 }
       },          
        "Tube": {      
            "0-1.99": { min: 1.81, avg: 1.81, max: 1.82 },
            "2-3.99": { min: 1.80, avg: 1.83, max: 1.96 },
            "4-6.99": { min: 1.80, avg: 1.83, max: 2.21 },
            "7-9.99": { min: 1.82, avg: 1.90, max: 2.26 },
            "10-13.99": { min: 1.82, avg: 1.82, max: 1.82 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }          
       }
    },
    "4130-110": {
        "Bar": {      
            "0-1.99": { min: 1.81, avg: 1.81, max: 1.82 },
            "2-3.99": { min: 1.80, avg: 1.83, max: 1.96 },
            "4-6.99": { min: 1.82, avg: 1.83, max: 1.83 },
            "7-9.99": { min: 1.82, avg: 1.83, max: 1.83 },
            "10-13.99": { min: 1.82, avg: 1.82, max: 1.82 },
            "14-22": { min: 1.35, avg: 1.78, max: 1.82 }
       },          
        "Tube": {      
            "0-1.99": { min: 1.81, avg: 1.81, max: 1.82 },
            "2-3.99": { min: 1.80, avg: 1.83, max: 1.96 },
            "4-6.99": { min: 1.80, avg: 1.83, max: 2.21 },
            "7-9.99": { min: 1.82, avg: 1.90, max: 2.26 },
            "10-13.99": { min: 1.82, avg: 1.82, max: 1.82 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }          
       }
    },
    "4130-140": {
        "Bar": {      
            "0-1.99": { min: 1.81, avg: 1.81, max: 1.82 },
            "2-3.99": { min: 1.80, avg: 1.83, max: 1.96 },
            "4-6.99": { min: 1.82, avg: 1.83, max: 1.83 },
            "7-9.99": { min: 1.82, avg: 1.83, max: 1.83 },
            "10-13.99": { min: 1.82, avg: 1.82, max: 1.82 },
            "14-22": { min: 1.35, avg: 1.78, max: 1.82 }
       },          
        "Tube": {      
            "0-1.99": { min: 1.81, avg: 1.81, max: 1.82 },
            "2-3.99": { min: 1.80, avg: 1.83, max: 1.96 },
            "4-6.99": { min: 1.80, avg: 1.83, max: 2.21 },
            "7-9.99": { min: 1.82, avg: 1.90, max: 2.26 },
            "10-13.99": { min: 1.82, avg: 1.82, max: 1.82 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }          
       }
    },
    "4140-80": {
        "Bar": {      
            "0-1.99": { min: 1.73, avg: 1.73, max: 1.84 },
            "2-3.99": { min: 0.97, avg: 1.45, max: 1.60 },
            "4-6.99": { min: 0.98, avg: 1.09, max: 1.29 },
            "7-9.99": { min: 0.98, avg: 1.09, max: 1.84 },
            "10-13.99": { min: 1.25, avg: 1.32, max: 1.46 },
            "14-22": { min: 1.73, avg: 1.73, max: 1.78 }
       },          
        "Tube": {      
            "0-1.99": { min: 1.73, avg: 1.73, max: 1.84 },
            "2-3.99": { min: 1.82, avg: 1.83, max: 1.96 },
            "4-6.99": { min: 1.25, avg: 1.32, max: 1.84 },
            "7-9.99": { min: 1.37, avg: 1.82, max: 1.83 },
            "10-13.99": { min: 1.37, avg: 1.82, max: 1.83 },
            "14-22": { min: 1.82, avg: 1.82, max: 1.84 }          
       }
    },
    "4140-100": {
        "Bar": {      
            "0-1.99": { min: 1.57, avg: 1.62, max: 1.69 },
            "2-3.99": { min: 1.57, avg: 1.62, max: 1.69 },
            "4-6.99": { min: 1.57, avg: 1.62, max: 1.69 },
            "7-9.99": { min: 1.57, avg: 1.62, max: 1.69 },
            "10-13.99": {min: 1.57, avg: 1.62, max: 1.69 },
            "14-22": { min: 1.57, avg: 1.62, max: 1.69 }
       },          
        "Tube": {      
            "0-1.99": { min: 1.57, avg: 1.62, max: 1.69 },
            "2-3.99": { min: 1.57, avg: 1.62, max: 1.69 },
            "4-6.99": { min: 1.57, avg: 1.62, max: 1.69 },
            "7-9.99": { min: 1.57, avg: 1.62, max: 1.69 },
            "10-13.99": {min: 1.57, avg: 1.62, max: 1.69 },
            "14-22": { min: 1.57, avg: 1.62, max: 1.69 }   
       }
    },
    "4140-110": {
        "Bar": {      
            "0-1.99": { min: 1.78, avg: 1.96, max: 2.73 },
            "2-3.99": { min: 1.47, avg: 1.53, max: 1.74 },
            "4-6.99": { min: 1.36, avg: 1.41, max: 1.64 },
            "7-9.99": { min: 1.28, avg: 1.39, max: 1.66 },
            "10-13.99": { min: 1.35, avg: 1.61, max: 1.72 },
            "14-22": { min: 1.35, avg: 1.61, max: 1.72 }
       },          
        "Tube": {      
            "0-1.99": { min: 1.78, avg: 1.96, max: 2.73 },
            "2-3.99": { min: 1.37, avg: 1.82, max: 1.83 },
            "4-6.99": { min: 1.47, avg: 1.53, max: 1.74 },
            "7-9.99": { min: 1.47, avg: 1.88, max: 2.29 },
            "10-13.99": { min: 1.59, avg: 1.64, max: 1.81 },
            "14-22": { min: 1.59, avg: 1.64, max: 1.81 }          
        }
    },
    "4140-120": {
        "Bar": {      
            "0-1.99": { min: 1.78, avg: 1.96, max: 2.73 },
            "2-3.99": { min: 1.47, avg: 1.53, max: 1.74 },
            "4-6.99": { min: 1.36, avg: 1.41, max: 1.64 },
            "7-9.99": { min: 1.28, avg: 1.39, max: 1.66 },
            "10-13.99": { min: 1.35, avg: 1.61, max: 1.72 },
            "14-22": { min: 1.35, avg: 1.61, max: 1.72 }
       },          
        "Tube": {      
            "0-1.99": { min: 1.78, avg: 1.96, max: 2.73 },
            "2-3.99": { min: 1.37, avg: 1.82, max: 1.83 },
            "4-6.99": { min: 1.47, avg: 1.53, max: 1.74 },
            "7-9.99": { min: 1.47, avg: 1.88, max: 2.29 },
            "10-13.99": { min: 1.59, avg: 1.64, max: 1.81 },
            "14-22": { min: 1.59, avg: 1.64, max: 1.81 }          
        }
    },
    "4142": {
        "Bar": {      
            "0-1.99": { min: 1.78, avg: 1.96, max: 2.73 },
            "2-3.99": { min: 1.47, avg: 1.53, max: 1.74 },
            "4-6.99": { min: 1.36, avg: 1.41, max: 1.64 },
            "7-9.99": { min: 1.28, avg: 1.39, max: 1.66 },
            "10-13.99": { min: 1.35, avg: 1.61, max: 1.72 },
            "14-22": { min: 1.35, avg: 1.61, max: 1.72 }
       },          
        "Tube": {      
            "0-1.99": { min: 1.78, avg: 1.96, max: 2.73 },
            "2-3.99": { min: 1.37, avg: 1.82, max: 1.83 },
            "4-6.99": { min: 1.47, avg: 1.53, max: 1.74 },
            "7-9.99": { min: 1.47, avg: 1.88, max: 2.29 },
            "10-13.99": { min: 1.59, avg: 1.64, max: 1.81 },
            "14-22": { min: 1.59, avg: 1.64, max: 1.81 }          
        }
    },
    "4145-100": {
        "Bar": {      
            "0-1.99": { min: 1.98, avg: 2.0, max: 2.05 },
            "2-3.99": { min: 1.35, avg: 1.38, max: 1.46 },
            "4-6.99": { min: 1.35, avg: 1.48, max: 1.62 },
            "7-9.99": { min: 1.47, avg: 1.57, max: 1.87 },
            "10-13.99": { min: 1.43, avg: 1.69, max: 1.87 },
            "14-22": { min: 1.43, avg: 1.55, max: 1.6 }
        },         
        "Tube": {      
            "0-1.99": { min: 1.98, avg: 2.0, max: 2.05 },
            "2-3.99": { min: 1.35, avg: 1.38, max: 1.46 },
            "4-6.99": { min: 1.31, avg: 1.38, max: 1.42 },
            "7-9.99": { min: 1.31, avg: 1.38, max: 1.42 },
            "10-13.99": { min: 1.31, avg: 1.38, max: 1.42 },
            "14-22": { min: 0.82, avg: 0.82, max: 0.82 }          
        }
    },
    "4145-110": {
        "Bar": {      
            "0-1.99": { min: 1.98, avg: 2.0, max: 2.05 },
            "2-3.99": { min: 1.35, avg: 1.38, max: 1.46 },
            "4-6.99": { min: 1.35, avg: 1.48, max: 1.62 },
            "7-9.99": { min: 1.47, avg: 1.57, max: 1.87 },
            "10-13.99": { min: 1.43, avg: 1.69, max: 1.87 },
            "14-22": { min: 1.43, avg: 1.55, max: 1.6 }
        },         
        "Tube": {      
            "0-1.99": { min: 1.98, avg: 2.0, max: 2.05 },
            "2-3.99": { min: 1.35, avg: 1.38, max: 1.46 },
            "4-6.99": { min: 1.31, avg: 1.38, max: 1.42 },
            "7-9.99": { min: 1.31, avg: 1.38, max: 1.42 },
            "10-13.99": { min: 1.31, avg: 1.38, max: 1.42 },
            "14-22": { min: 0.82, avg: 0.82, max: 0.82 }          
        }
    },
    "4145-120": {
        "Bar": {      
            "0-1.99": { min: 1.98, avg: 2.0, max: 2.05 },
            "2-3.99": { min: 1.35, avg: 1.38, max: 1.46 },
            "4-6.99": { min: 1.35, avg: 1.48, max: 1.62 },
            "7-9.99": { min: 1.47, avg: 1.57, max: 1.87 },
            "10-13.99": { min: 1.43, avg: 1.69, max: 1.87 },
            "14-22": { min: 1.43, avg: 1.55, max: 1.6 }
        },         
        "Tube": {      
            "0-1.99": { min: 1.98, avg: 2.0, max: 2.05 },
            "2-3.99": { min: 1.35, avg: 1.38, max: 1.46 },
            "4-6.99": { min: 1.31, avg: 1.38, max: 1.42 },
            "7-9.99": { min: 1.31, avg: 1.38, max: 1.42 },
            "10-13.99": { min: 1.31, avg: 1.38, max: 1.42 },
            "14-22": { min: 0.82, avg: 0.82, max: 0.82 }          
        }
    },
    "4145-125": {
        "Bar": {      
            "0-1.99": { min: 1.98, avg: 2.0, max: 2.05 },
            "2-3.99": { min: 1.35, avg: 1.38, max: 1.46 },
            "4-6.99": { min: 1.35, avg: 1.48, max: 1.62 },
            "7-9.99": { min: 1.47, avg: 1.57, max: 1.87 },
            "10-13.99": { min: 1.43, avg: 1.69, max: 1.87 },
            "14-22": { min: 1.43, avg: 1.55, max: 1.6 }
        },         
        "Tube": {      
            "0-1.99": { min: 1.98, avg: 2.0, max: 2.05 },
            "2-3.99": { min: 1.35, avg: 1.38, max: 1.46 },
            "4-6.99": { min: 1.31, avg: 1.38, max: 1.42 },
            "7-9.99": { min: 1.31, avg: 1.38, max: 1.42 },
            "10-13.99": { min: 1.31, avg: 1.38, max: 1.42 },
            "14-22": { min: 0.82, avg: 0.82, max: 0.82 }          
        }
    },
    "4330-130": {
        "Bar": {      
            "0-1.99": { min: 2.6, avg: 3.1, max: 3.6 },
            "2-3.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "4-6.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "7-9.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "10-13.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "14-22": { min: 2.03, avg: 2.34, max: 2.63 }
        },         
        "Tube": {      
            "0-1.99": { min: 2.6, avg: 3.1, max: 3.6 },
            "2-3.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "4-6.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "7-9.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "10-13.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "14-22": { min: 2.03, avg: 2.34, max: 2.63 }          
       }
    },
    "4330-150": {
        "Bar": {      
            "0-1.99": { min: 2.6, avg: 3.1, max: 3.6 },
            "2-3.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "4-6.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "7-9.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "10-13.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "14-22": { min: 2.03, avg: 2.34, max: 2.63 }
        },         
        "Tube": {      
            "0-1.99": { min: 2.6, avg: 3.1, max: 3.6 },
            "2-3.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "4-6.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "7-9.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "10-13.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "14-22": { min: 2.03, avg: 2.34, max: 2.63 }          
       }
    },
    "4330-165": {
        "Bar": {      
            "0-1.99": { min: 2.6, avg: 3.1, max: 3.6 },
            "2-3.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "4-6.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "7-9.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "10-13.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "14-22": { min: 2.03, avg: 2.34, max: 2.63 }
        },         
        "Tube": {      
            "0-1.99": { min: 2.6, avg: 3.1, max: 3.6 },
            "2-3.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "4-6.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "7-9.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "10-13.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "14-22": { min: 2.03, avg: 2.34, max: 2.63 }          
       }
    },
    "4330-170": {
        "Bar": {      
            "0-1.99": { min: 2.6, avg: 3.1, max: 3.6 },
            "2-3.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "4-6.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "7-9.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "10-13.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "14-22": { min: 2.03, avg: 2.34, max: 2.63 }
        },
    },
    "4340-140": {
        "Bar": {      
            "0-1.99": { min: 2.6, avg: 3.1, max: 3.6 },
            "2-3.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "4-6.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "7-9.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "10-13.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "14-22": { min: 2.03, avg: 2.34, max: 2.63 }
        },         
        "Tube": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "4-6.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "7-9.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "10-13.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "14-22": { min: 2.03, avg: 2.34, max: 2.63 }          
       }
    },
    "4360": {
         "Bar": {      
            "0-1.99": { min: 2.6, avg: 3.1, max: 3.6 },
            "2-3.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "4-6.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "7-9.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "10-13.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "14-22": { min: 2.03, avg: 2.34, max: 2.63 }
        },         
        "Tube": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "4-6.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "7-9.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "10-13.99": { min: 2.03, avg: 2.34, max: 2.63 },
            "14-22": { min: 2.03, avg: 2.34, max: 2.63 }          
       }
    },
    "4715": {
        "Bar": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "4-6.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 1.5, avg: 1.65, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
         },        
         "Tube": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "4-6.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 1.5, avg: 1.65, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }         
        }
    },
    "4815": {
        "Bar": {      
            "0-1.99": { min: 0.85, avg: 0.95, max: 1.2 },
            "2-3.99": { min: 0.85, avg: 0.95, max: 1.2 },
            "4-6.99": { min: 0.85, avg: 0.95, max: 1.2 },
            "7-9.99": { min: 0.85, avg: 0.95, max: 1.2 },
            "10-13.99": { min: 0.85, avg: 0.95, max: 1.2 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
         },        
        "Tube": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 0.85, avg: 0.95, max: 1.2 },
            "4-6.99": { min: 0.85, avg: 0.95, max: 1.2 },
            "7-9.99": { min: 0.85, avg: 0.95, max: 1.2 },
            "10-13.99": { min: 0.85, avg: 0.95, max: 1.2 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }          
       }
    },
    "8620": {
        "Bar": {      
            "0-1.99": { min: 0.7, avg: 0.8, max: 1.12 },
            "2-3.99": { min: 0.82, avg: 1.15, max: 1.97 },
            "4-6.99": { min: 0.82, avg: 1.15, max: 1.97 },
            "7-9.99": { min: 0.97, avg: 1.15, max: 1.65 },
            "10-13.99": { min: 1.00, avg: 2.77, max: 3.75 },
            "14-22": { min: 1.00, avg: 2.77, max: 3.75 }
       },          
        "Tube": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 1.67, avg: 1.75, max: 2.03 },
            "4-6.99": { min: 1.67, avg: 1.75, max: 2.03 },
            "7-9.99": { min: 1.67, avg: 1.75, max: 2.03 },
            "10-13.99": { min: 1.00, avg: 1.77, max: 0.0 },
            "14-22": { min: 1.00, avg: 2.77, max: 0.0 }          
        }
    },
    "8630": {
        "Bar": {      
            "0-1.99": { min: 0.7, avg: 0.8, max: 1.12 },
            "2-3.99": { min: 0.82, avg: 1.15, max: 1.97 },
            "4-6.99": { min: 0.82, avg: 1.15, max: 1.97 },
            "7-9.99": { min: 0.97, avg: 1.15, max: 1.65 },
            "10-13.99": { min: 1.00, avg: 2.77, max: 3.75 },
            "14-22": { min: 1.00, avg: 2.77, max: 3.75 }
       },          
        "Tube": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 1.67, avg: 1.75, max: 2.03 },
            "4-6.99": { min: 1.67, avg: 1.75, max: 2.03 },
            "7-9.99": { min: 1.67, avg: 1.75, max: 2.03 },
            "10-13.99": { min: 1.00, avg: 1.77, max: 0.0 },
            "14-22": { min: 1.00, avg: 2.77, max: 0.0 }          
        }
    },
    "9310": {
        "Bar": {      
            "0-1.99": { min: 2.03, avg: 2.45, max: 3.56 },
            "2-3.99": { min: 2.03, avg: 2.45, max: 3.56 },
            "4-6.99": { min: 2.03, avg: 2.45, max: 3.56 },
            "7-9.99": { min: 2.03, avg: 2.45, max: 3.56 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
        }
    },
    "9CR": {
        "Bar": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 2.37, avg: 2.65, max: 2.90 },
            "4-6.99": { min: 2.37, avg: 2.65, max: 2.90 },
            "7-9.99": { min: 2.37, avg: 2.65, max: 2.90 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
         },        
         "Tube": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 2.37, avg: 2.65, max: 2.90 },
            "4-6.99": { min: 2.37, avg: 2.65, max: 2.90 },
            "7-9.99": { min: 2.37, avg: 2.65, max: 2.90 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }         
        }
    },
    "13CR": {
        "Bar": {     
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 3.04, avg: 3.25, max: 3.59 },
            "4-6.99": { min: 3.04, avg: 3.25, max: 3.59 },
            "7-9.99": { min: 3.04, avg: 3.25, max: 3.59 },
            "10-13.99": { min: 3.04, avg: 3.25, max: 3.59 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
        },         
        "Tube": {     
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 3.04, avg: 3.25, max: 3.59 },
            "4-6.99": { min: 3.04, avg: 3.25, max: 3.59 },
            "7-9.99": { min: 3.04, avg: 3.25, max: 3.59 },
            "10-13.99": { min: 3.04, avg: 3.25, max: 3.59 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }          
        }
    },
    "25CR": {
        "Bar": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "4-6.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "7-9.99": { min: 13.97, avg: 14.1, max: 14.8 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
        },         
         "Tube": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "4-6.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }         
         }
    },
    "28CR-110": {
        "Bar": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 14.22, avg: 14.55, max: 14.87 },
            "4-6.99": { min: 14.22, avg: 14.55, max: 14.87 },
            "7-9.99": { min: 14.22, avg: 14.55, max: 14.87 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
        },         
          "Tube": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 14.22, avg: 14.55, max: 14.87 },
            "4-6.99": { min: 14.22, avg: 14.55, max: 14.87 },
            "7-9.99": { min: 14.22, avg: 14.55, max: 14.87 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }        
         }
    },
    "28CR-125": {
        "Bar": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 14.22, avg: 14.55, max: 14.87 },
            "4-6.99": { min: 14.22, avg: 14.55, max: 14.87 },
            "7-9.99": { min: 14.22, avg: 14.55, max: 14.87 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
        },         
          "Tube": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 14.22, avg: 14.55, max: 14.87 },
            "4-6.99": { min: 14.22, avg: 14.55, max: 14.87 },
            "7-9.99": { min: 14.22, avg: 14.55, max: 14.87 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }        
         }
    },
    "SUPER13CR-95": {
        "Bar": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 9.46, avg: 13.41, max: 13.74 },
            "4-6.99": { min: 9.46, avg: 13.41, max: 13.74 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
        },         
        "Tube": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 9.46, avg: 13.41, max: 13.74 },
            "4-6.99": { min: 9.46, avg: 13.41, max: 13.74 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }          
        }
    },
    "SUPER13CR-110": {
        "Bar": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 4.75, avg: 5.21, max: 5.77 },
            "4-6.99": { min: 3.78, avg: 4.21, max: 4.83 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
        },         
        "Tube": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 4.75, avg: 5.21, max: 5.77 },
            "4-6.99": { min: 3.78, avg: 4.21, max: 4.83 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }          
        }
    },
    "17-4PH H900": {
        "Bar": {      
            "0-1.99": { min: 3.46, avg: 3.67, max: 3.82 },
            "2-3.99": { min: 3.46, avg: 3.67, max: 3.82 },
            "4-6.99": { min: 3.46, avg: 3.67, max: 3.82 },
            "7-9.99": { min: 3.46, avg: 3.67, max: 3.82 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
       }
    },
    "17-4PH H1075": {
        "Bar": {      
            "0-1.99": { min: 5.61, avg: 6.30, max: 6.89 },
            "2-3.99": { min: 5.61, avg: 6.30, max: 6.89 },
            "4-6.99": { min: 5.61, avg: 6.30, max: 6.89 },
            "7-9.99": { min: 5.61, avg: 6.30, max: 6.89 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
       }
    },
    "17-4PH H1150": {
        "Bar": {      
            "0-1.99": { min: 4.78, avg: 4.96, max: 5.60 },
            "2-3.99": { min: 4.78, avg: 4.96, max: 5.60 },
            "4-6.99": { min: 4.78, avg: 4.96, max: 5.60 },
            "7-9.99": { min: 4.78, avg: 4.96, max: 5.60 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
       }
    },
    "15-5PH": {
        "Bar": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "4-6.99": { min: 6.93, avg: 8.29, max: 10.31 },
            "7-9.99": { min: 6.93, avg: 8.29, max: 10.31 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
       }
    },
    "300": {
        "Bar": {      
            "0-1.99": { min: 3.82, avg: 4.38, max: 5.41 },
            "2-3.99": { min: 3.82, avg: 4.38, max: 5.41 },
            "4-6.99": { min: 3.82, avg: 4.38, max: 5.41 },
            "7-9.99": { min: 3.82, avg: 4.38, max: 5.41 },
            "10-13.99": { min: 3.82, avg: 4.38, max: 5.41 },
            "14-22": { min: 3.82, avg: 4.38, max: 5.41 }
       }
    },
    "303": {
        "Bar": {      
            "0-1.99": { min: 3.82, avg: 4.38, max: 5.41 },
            "2-3.99": { min: 3.82, avg: 4.38, max: 5.41 },
            "4-6.99": { min: 3.82, avg: 4.38, max: 5.41 },
            "7-9.99": { min: 3.82, avg: 4.38, max: 5.41 },
            "10-13.99": { min: 3.82, avg: 4.38, max: 5.41 },
            "14-22": { min: 3.82, avg: 4.38, max: 5.41 }
       }
    },
    "316": {
        "Bar": {      
            "0-1.99": { min: 3.82, avg: 4.38, max: 5.41 },
            "2-3.99": { min: 3.82, avg: 4.38, max: 5.41 },
            "4-6.99": { min: 3.82, avg: 4.38, max: 5.41 },
            "7-9.99": { min: 3.82, avg: 4.38, max: 5.41 },
            "10-13.99": { min: 3.82, avg: 4.38, max: 5.41 },
            "14-22": { min: 3.82, avg: 4.38, max: 5.41 }
       }
    },
    "416": {
        "Bar": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 3.36, avg: 3.55, max: 3.91 },
            "4-6.99": { min: 3.36, avg: 3.55, max: 3.91 },
            "7-9.99": { min: 3.36, avg: 3.55, max: 3.91 },
            "10-13.99": { min: 2.91, avg: 2.91, max: 2.91 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
       }
    },
    "431": {
        "Bar": {     
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 2.71, avg: 2.75, max: 3.03 },
            "4-6.99": { min: 2.71, avg: 2.75, max: 3.03 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
       }
    },
    "718": {
        "Bar": {      
            "0-1.99": { min: 24.32, avg: 24.78, max: 25.77 },
            "2-3.99": { min: 24.32, avg: 24.78, max: 25.77 },
            "4-6.99": { min: 24.32, avg: 24.78, max: 25.77 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
       }
    },
    "825": {
        "Bar": {      
            "0-1.99": { min: 22.50, avg: 27.31, max: 33.31 },
            "2-3.99": { min: 22.50, avg: 27.31, max: 33.31 },
            "4-6.99": { min: 22.50, avg: 27.31, max: 33.31 },
            "7-9.99": { min: 22.50, avg: 27.31, max: 33.31 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
       }
    },
    "925": {
        "Bar": {      
            "0-1.99": { min: 22.50, avg: 27.31, max: 33.31 },
            "2-3.99": { min: 22.50, avg: 27.31, max: 33.31 },
            "4-6.99": { min: 22.50, avg: 27.31, max: 33.31 },
            "7-9.99": { min: 22.50, avg: 27.31, max: 33.31 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
       }
    },
    "A36": {
        "Bar": {     
            "0-1.99": { min: 3.05, avg: 3.09, max: 3.12 },
            "2-3.99": { min: 3.05, avg: 3.09, max: 3.12 },
            "4-6.99": { min: 3.05, avg: 3.09, max: 3.12 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
       },          
        "Tube": {     
            "0-1.99": { min: 3.05, avg: 3.09, max: 3.12 },
            "2-3.99": { min: 3.05, avg: 3.09, max: 3.12 },
            "4-6.99": { min: 3.05, avg: 3.09, max: 3.12 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }          
         }
    },
    "A106": {
        "Bar": {     
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "4-6.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
         },        
        "Tube": {     
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "4-6.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }          
       }
    },
    "A108": {
        "Bar": {      
            "0-1.99": { min: 1.0, avg: 1.31, max: 1.6 },
            "2-3.99": { min: 1.0, avg: 1.31, max: 1.6 },
            "4-6.99": { min: 1.0, avg: 1.31, max: 1.6 },
            "7-9.99": { min: 1.0, avg: 1.31, max: 1.6 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
       },          
        "Tube": {      
            "0-1.99": { min: 1.0, avg: 1.31, max: 1.6 },
            "2-3.99": { min: 1.0, avg: 1.31, max: 1.6 },
            "4-6.99": { min: 1.0, avg: 1.31, max: 1.6 },
            "7-9.99": { min: 1.0, avg: 1.31, max: 1.6 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }          
       }
    },
    "A193": {
        "Bar": {      
            "0-1.99": { min: 2.38, avg: 2.67, max: 4.18 },
            "2-3.99": { min: 2.38, avg: 2.67, max: 2.67 },
            "4-6.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
        },         
        "Tube": {      
            "0-1.99": { min: 2.38, avg: 2.67, max: 4.18 },
            "2-3.99": { min: 2.38, avg: 2.67, max: 2.67 },
            "4-6.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }          
        }
    },
    "A350": {
        "Bar": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 1.72, avg: 1.72, max: 1.72 },
            "4-6.99": { min: 1.0, avg: 1.22, max: 1.44 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
        },         
        "Tube": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 1.72, avg: 1.72, max: 1.72 },
            "4-6.99": { min: 1.0, avg: 1.22, max: 1.44 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }          
        }
    },
    "A519": {
        "Bar": {      
            "0-1.99": { min: 2.0, avg: 2.0, max: 2.0 },
            "2-3.99": { min: 2.0, avg: 2.0, max: 2.0 },
            "4-6.99": { min: 2.0, avg: 2.0, max: 2.0 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
       },          
        "Tube": {      
            "0-1.99": { min: 2.0, avg: 2.0, max: 2.0 },
            "2-3.99": { min: 2.0, avg: 2.0, max: 2.0 },
            "4-6.99": { min: 2.0, avg: 2.0, max: 2.0 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }          
       }
    },
    "ALUM 2024-T4": {
        "Bar": {      
            "0-1.99": { min: 7.04, avg: 7.04, max: 7.57 },
            "2-3.99": { min: 7.04, avg: 7.04, max: 7.57 },
            "4-6.99": { min: 7.04, avg: 7.04, max: 7.57 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
        },         
        "Tube": {      
            "0-1.99": { min: 7.04, avg: 7.04, max: 7.57 },
            "2-3.99": { min: 7.04, avg: 7.04, max: 7.57 },
            "4-6.99": { min: 7.04, avg: 7.04, max: 7.57 },
            "7-9.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }          
       }
    },
    "ALUM 6061": {
        "Bar": {      
            "0-1.99": { min: 4.0, avg: 4.5, max: 4.91 },
            "2-3.99": { min: 4.0, avg: 4.0, max: 4.0 },
            "4-6.99": { min: 3.8, avg: 4.0, max: 4.08 },
            "7-9.99": { min: 3.8, avg: 4.0, max: 4.08 },
            "10-13.99": { min: 3.8, avg: 4.0, max: 4.08 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
        },         
         "Tube": {      
            "0-1.99": { min: 4.0, avg: 4.5, max: 4.91 },
            "2-3.99": { min: 4.0, avg: 4.0, max: 4.0 },
            "4-6.99": { min: 3.8, avg: 4.0, max: 4.08 },
            "7-9.99": { min: 3.8, avg: 4.0, max: 4.08 },
            "10-13.99": { min: 3.8, avg: 4.0, max: 4.08 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }         
          }
    },
    "ALUM 7075-T6": {
        "Bar": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 5.4, avg: 5.71, max: 6.34 },
            "4-6.99": { min: 5.4, avg: 5.71, max: 6.34 },
            "7-9.99": { min: 5.4, avg: 5.71, max: 6.34 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }
         },        
        "Tube": {      
            "0-1.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "2-3.99": { min: 5.4, avg: 5.71, max: 6.34 },
            "4-6.99": { min: 5.4, avg: 5.71, max: 6.34 },
            "7-9.99": { min: 5.4, avg: 5.71, max: 6.34 },
            "10-13.99": { min: 0.0, avg: 0.0, max: 0.0 },
            "14-22": { min: 0.0, avg: 0.0, max: 0.0 }          
        }
    },
    // Add more grades here in the same format
};

function toggleUnitSystem() {
    const unitSystem = document.querySelector('input[name="unit-system"]:checked').value;

    const outerDiaInch = document.getElementById('outerDiaInch').value || 0;
    const innerDiaInch = document.getElementById('innerDiaInch').value || 0;
    const lengthInch = document.getElementById('lengthInch').value || 0;
    const weightInch = document.getElementById('weightInch').value || 0;

    const outerDiaMetric = document.getElementById('outerDiaMetric').value || 0;
    const innerDiaMetric = document.getElementById('innerDiaMetric').value || 0;
    const lengthMetric = document.getElementById('lengthMetric').value || 0;
    const weightMetric = document.getElementById('weightMetric').value || 0;

    // Convert inch to metric or vice versa
    if (unitSystem === 'metric') {
        document.getElementById('outerDiaMetric').value = (outerDiaInch * 25.4).toFixed(2);
        document.getElementById('innerDiaMetric').value = (innerDiaInch * 25.4).toFixed(2);
        document.getElementById('lengthMetric').value = (lengthInch * 25.4).toFixed(2);
        document.getElementById('weightMetric').value = (weightInch * 0.453592).toFixed(2);
    } else if (unitSystem === 'inch') {
        document.getElementById('outerDiaInch').value = (outerDiaMetric / 25.4).toFixed(2);
        document.getElementById('innerDiaInch').value = (innerDiaMetric / 25.4).toFixed(2);
        document.getElementById('lengthInch').value = (lengthMetric / 25.4).toFixed(2);
        document.getElementById('weightInch').value = (weightMetric / 0.453592).toFixed(2);
    }

    document.getElementById("material-form-inch").style.display = unitSystem === 'inch' ? 'block' : 'none';
    document.getElementById("material-form-metric").style.display = unitSystem === 'metric' ? 'block' : 'none';

    // Reapply colors after switching unit systems
    resetPriceFieldColors();
    applyPriceFieldColorBasedOnCorrections();
}

function resetPriceFieldColors() {
    ['costMinInch', 'costAvgInch', 'costMaxInch', 'costMinMetric', 'costAvgMetric', 'costMaxMetric'].forEach(id => {
        document.getElementById(id).style.backgroundColor = '';
    });
}

function applyPriceFieldColorBasedOnCorrections() {
    const unitSystem = document.querySelector('input[name="unit-system"]:checked').value;
    const selectedMaterial = unitSystem === 'metric'
        ? document.getElementById("materialGradeMetric").value
        : document.getElementById("materialGradeInch").value;

    const outerDia = unitSystem === 'metric'
        ? parseFloat(document.getElementById("outerDiaMetric").value) / 25.4
        : parseFloat(document.getElementById("outerDiaInch").value);

    const corrections = getCorrectionPercentage(selectedMaterial, outerDia);
    if (corrections) {
        colorPriceFields(`costMin${capitalize(unitSystem)}`, corrections.min, selectedMaterial);
        colorPriceFields(`costAvg${capitalize(unitSystem)}`, corrections.avg, selectedMaterial);
        colorPriceFields(`costMax${capitalize(unitSystem)}`, corrections.max, selectedMaterial);
    }
}

function toggleCorrectionTable() {
    const correctionTableSection = document.getElementById("correctionTableSection");

    correctionTableSection.style.display = correctionTableSection.style.display === "none" || correctionTableSection.style.display === "" ? "block" : "none";

    const editButton = document.getElementById("edit-table-button");
    if (correctionTableSection.style.display === "block") {
        editButton.textContent = "Hide Cost Correction Table";
        document.getElementById("save-button").style.display = "inline";
        document.getElementById("cancel-button").style.display = "inline";
    } else {
        editButton.textContent = "Edit Cost Correction Table";
        document.getElementById("save-button").style.display = "none";
        document.getElementById("cancel-button").style.display = "none";
    }
}

function toggleInnerDiaInch() {
    const materialTypeInch = document.getElementById("materialTypeInch").value;
    const innerDiaInchField = document.getElementById("innerDiaInch");

    if (materialTypeInch === 'Bar') {
        innerDiaInchField.value = "";
        innerDiaInchField.disabled = true;
        innerDiaInchField.style.backgroundColor = "#e9ecef";
    } else {
        innerDiaInchField.disabled = false;
        innerDiaInchField.style.backgroundColor = "";
    }
}

function toggleInnerDiaMetric() {
    const materialTypeMetric = document.getElementById("materialTypeMetric").value;
    const innerDiaMetricField = document.getElementById("innerDiaMetric");

    if (materialTypeMetric === 'Bar') {
        innerDiaMetricField.value = "";
        innerDiaMetricField.disabled = true;
        innerDiaMetricField.style.backgroundColor = "#e9ecef";
    } else {
        innerDiaMetricField.disabled = false;
        innerDiaMetricField.style.backgroundColor = "";
    }
}

function populateMaterialGrades(system) {
    const materials = ["1015", "1018", "1040", "1044", "4130-70", "4130-80", "4130-90", "4130-110", "4130-140", "4140-80", "4140-100", "4140-110", "4140-120", "4142", "4145-100", "4145-110", "4145-120", "4145-125", "4330-130", "4330-150", "4330-165", "4330-170", "4340-140", "4360", "4715", "4815", "8620", "8630", "9310", "9CR", "13CR", "25CR", "28CR-110", "28CR-125", "SUPER13CR-95", "SUPER13CR-110", "17-4PH H900", "17-4PH H1075", "17-4PH H1150", "15-5PH", "300", "303", "316", "416", "431", "718", "825", "925", "A36", "A106", "A108", "A193", "A350", "A519", "ALUM 2024-T4", "ALUM 6061", "ALUM 7075-T6"];

    const materialGradeSelect = document.getElementById(`materialGrade${capitalize(system)}`);
    materialGradeSelect.innerHTML = ''; // Clear existing options
    materials.forEach(material => {
        const option = document.createElement("option");
        option.value = material;
        option.textContent = material;
        materialGradeSelect.appendChild(option);
    });
}

function calculateCost(system) {
    const materialType = document.getElementById(`materialType${capitalize(system)}`).value;
    let outerDia, innerDia, length;

    if (system === 'inch') {
        outerDia = parseFloat(document.getElementById(`outerDia${capitalize(system)}`).value);
        innerDia = parseFloat(document.getElementById(`innerDia${capitalize(system)}`).value) || 0;
        length = parseFloat(document.getElementById(`length${capitalize(system)}`).value);
    } else if (system === 'metric') {
        outerDia = parseFloat(document.getElementById(`outerDia${capitalize(system)}`).value) / 25.4;
        innerDia = parseFloat(document.getElementById(`innerDia${capitalize(system)}`).value) / 25.4 || 0;
        length = parseFloat(document.getElementById(`length${capitalize(system)}`).value) / 25.4;
    }

    const materialGrade = document.getElementById(`materialGrade${capitalize(system)}`).value;
    const density = getDensity(materialGrade);

    let weight;
    if (materialType === "Bar") {
        weight = Math.PI * Math.pow(outerDia / 2, 2) * length * density;
    } else if (materialType === "Tube") {
        weight = Math.PI * (Math.pow(outerDia / 2, 2) - Math.pow(innerDia / 2, 2)) * length * density;
    }

    const weightElement = document.getElementById(`weight${capitalize(system)}`);
    const costMinElement = document.getElementById(`costMin${capitalize(system)}`);
    const costAvgElement = document.getElementById(`costAvg${capitalize(system)}`);
    const costMaxElement = document.getElementById(`costMax${capitalize(system)}`);

    // Use weight in pounds directly for pricing
    weightElement.value = weight.toFixed(2); // in pounds

    // Determine the price per pound based on material grade, material type, and diameter range
    const priceRange = getPriceRange(outerDia);
    const priceData = pricePerPoundData[materialGrade][materialType][priceRange];

    if (!priceData) {
        alert('No price data found for the selected material grade, type, and outer diameter range.');
        return;
    }

    const corrections = getCorrectionPercentage(materialGrade, outerDia);
    if (!corrections) {
        alert('No correction data found for the selected material grade and outer diameter range.');
        return;
    }

    // Apply corrections and calculate final prices using price per pound
    const priceMin = weight * priceData.min * (corrections.min / 100);
    const priceAvg = weight * priceData.avg * (corrections.avg / 100);
    const priceMax = weight * priceData.max * (corrections.max / 100);

    costMinElement.value = `$${priceMin.toFixed(2)}`;
    costAvgElement.value = `$${priceAvg.toFixed(2)}`;
    costMaxElement.value = `$${priceMax.toFixed(2)}`;

    colorPriceFields(`costMin${capitalize(system)}`, corrections.min, materialGrade);
    colorPriceFields(`costAvg${capitalize(system)}`, corrections.avg, materialGrade);
    colorPriceFields(`costMax${capitalize(system)}`, corrections.max, materialGrade);
}

function colorPriceFields(fieldId, correctionValue, selectedMaterial) {
    console.log(`Field: ${fieldId}, Correction Value: ${correctionValue}`);  // Debugging line
    const priceField = document.getElementById(fieldId);
    const currentMaterial = document.querySelector('input[name="unit-system"]:checked').value === 'metric'
        ? document.getElementById("materialGradeMetric").value
        : document.getElementById("materialGradeInch").value;

    // Only apply color if the correction value is not 100 and the material matches
    if (correctionValue !== 100 && selectedMaterial === currentMaterial) {
        priceField.style.backgroundColor = 'green'; // Change this color if needed
    } else {
        priceField.style.backgroundColor = ''; // Reset if the value is default (100%)
    }
}

function getCorrectionPercentage(materialGrade, outerDia) {
    const correctionTable = {};

    document.querySelectorAll("#costCorrectionTable tbody tr").forEach(row => {
        const grade = row.children[0].innerText;
        correctionTable[grade] = {};

        const ranges = ["0-1.99", "2-3.99", "4-6.99", "7-9.99", "10-13.99", "14-22"];

        ranges.forEach((range, i) => {
            correctionTable[grade][range] = {
                min: parseFloat(row.children[i * 3 + 1].innerText.replace('%', '')) || 100,
                avg: parseFloat(row.children[i * 3 + 2].innerText.replace('%', '')) || 100,
                max: parseFloat(row.children[i * 3 + 3].innerText.replace('%', '')) || 100,
            };
        });
    });

    let range = getPriceRange(outerDia);
    return correctionTable[materialGrade][range] || null;
}

function getPriceRange(outerDia) {
    if (outerDia >= 0 && outerDia <= 1.99) return "0-1.99";
    if (outerDia >= 2 && outerDia <= 3.99) return "2-3.99";
    if (outerDia >= 4 && outerDia <= 6.99) return "4-6.99";
    if (outerDia >= 7 && outerDia <= 9.99) return "7-9.99";
    if (outerDia >= 10 && outerDia <= 13.99) return "10-13.99";
    if (outerDia >= 14 && outerDia <= 22) return "14-22";
}

function getDensity(materialGrade) {
    const densityTable = {
        "300": 0.289,
        "303": 0.289,
        "316": 0.289,
        "416": 0.278,
        "431": 0.282,
        "718": 0.296,
	"825": 0.294,
        "925": 0.294,
        "1015": 0.284,
        "1018": 0.284,
        "1040": 0.283,
        "1044": 0.283,
        "4130-70": 0.283,
	"4130-80": 0.283,
	"4130-90": 0.283,
	"4130-110": 0.283,
	"4130-140": 0.283,
        "4140-80": 0.283,
        "4140-100": 0.283,
        "4140-110": 0.283,
        "4140-120": 0.283,
        "4145-100": 0.283,
        "4145-110": 0.283,
        "4145-120": 0.283,
        "4145-125": 0.283,
        "4330-130": 0.283,
        "4330-150": 0.283,
        "4330-165": 0.283,
        "4330-170": 0.283,
        "4340-140": 0.283,
        "4360": 0.283,
        "4715": 0.283,
        "4815": 0.283,
        "8620": 0.283,
        "8630": 0.283,
        "9310": 0.283,
        "9CR": 0.278,
        "13CR": 0.278,
        "25CR": 0.282,
        "28CR-110": 0.282,
	"28CR-125": 0.282,
        "SUPER13CR-95": 0.278,
        "SUPER13CR-110": 0.278,
        "7-4PH H900": 0.282,
        "17-4PH H1075": 0.282,
        "17-4PH H1150": 0.282,
        "15-5PH": 0.282,
        "A36": 0.283,
        "A106": 0.283,
        "A193": 0.283,
        "A350": 0.283,
        "A519": 0.283,
        "ALUM 2024-T4": 0.1,
        "ALUM 6061": 0.1,
        "ALUM 7075-T6": 0.1,
    };
    return densityTable[materialGrade] || 0.284;
}

function capitalize(str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
}

document.addEventListener("DOMContentLoaded", function () {
    enableEditingCorrectionTable();
});

let previousData = [];  // To store previous cell values
let previousColors = [];  // To store previous cell colors

function enableEditingCorrectionTable() {
    const editButton = document.getElementById("edit-table-button");
    const saveButton = document.getElementById("save-button");
    const cancelButton = document.getElementById("cancel-button");

    editButton.addEventListener("click", function () {
        toggleTableEditability(true);
        saveButton.style.display = "inline";
        cancelButton.style.display = "inline";

        // Save current table data and colors to revert on cancel
        const cells = document.querySelectorAll("#costCorrectionTable tbody td[contenteditable]");
        previousData = Array.from(cells).map(cell => cell.innerText);
        previousColors = Array.from(cells).map(cell => cell.style.backgroundColor); // Save original colors
    });

    saveButton.addEventListener("click", function () {
        toggleTableEditability(false);
        saveButton.style.display = "none";
        cancelButton.style.display = "none";
        applyTableCellColors();  // Apply final color logic after the edit is saved
    });

    cancelButton.addEventListener("click", function () {
        toggleTableEditability(false);
        saveButton.style.display = "none";
        cancelButton.style.display = "none";

        // Revert changes by restoring previous data and colors
        const cells = document.querySelectorAll("#costCorrectionTable tbody td[contenteditable]");
        cells.forEach((cell, index) => {
            cell.innerText = previousData[index];  // Restore previous values
            cell.style.backgroundColor = previousColors[index];  // Restore previous colors
        });
    });
}

function toggleTableEditability(editable) {
    const cells = document.querySelectorAll("#costCorrectionTable tbody td[contenteditable]");
    cells.forEach(cell => {
        cell.contentEditable = editable;
        if (editable) {
            cell.addEventListener('input', trackEdit); // Track when a cell is edited
        } else {
            cell.removeEventListener('input', trackEdit); // Remove tracking when editing is disabled
        }
    });
}

function trackEdit(event) {
    const cell = event.target;
    appendPercentageSymbol(cell);  // Ensure "%" is added if missing during editing
    cell.dataset.lastEdit = Date.now();  // Track the edit time in the dataset
}

function appendPercentageSymbol(cell) {
    if (!cell.innerText.includes("%")) {
        cell.innerText += "%";
    }
}

function applyTableCellColors() {
    const cells = document.querySelectorAll("#costCorrectionTable tbody td[contenteditable]");
    cells.forEach(cell => {
        const lastEdit = parseInt(cell.dataset.lastEdit || Date.now());  // Use the edit date or default to now
        applyCellColor(cell, lastEdit);  // Apply color to each cell based on last edit
    });
}

function applyCellColor(cell, lastEdit) {
    const daysSinceEdit = Math.floor((Date.now() - lastEdit) / (1000 * 60 * 60 * 24));  // Calculate days since last edit

    // Clear previous classes
    cell.classList.remove("edited-0-3", "edited-3-6", "edited-6-9", "edited-9");

    // Apply the appropriate color based on the edit time
    if (daysSinceEdit <= 90) {
        cell.classList.add("edited-0-3");
        cell.style.backgroundColor = 'green';  // Edited within the last 3 months
    } else if (daysSinceEdit > 90 && daysSinceEdit <= 180) {
        cell.classList.add("edited-3-6");
        cell.style.backgroundColor = 'yellow';  // Edited between 3-6 months
    } else if (daysSinceEdit > 180 && daysSinceEdit <= 270) {
        cell.classList.add("edited-6-9");
        cell.style.backgroundColor = 'orange';  // Edited between 6-9 months
    } else {
        cell.classList.add("edited-9");
        cell.style.backgroundColor = 'gray';  // Edited more than 9 months ago
    }
}
function saveTable() {
    // Add your save logic here
    toggleCorrectionTable(); // Disable editing after saving
}
